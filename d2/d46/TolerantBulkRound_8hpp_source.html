<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Dissent: src/Anonymity/Tolerant/TolerantBulkRound.hpp Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Dissent
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="../../dir_2616ea237e821f7c7ea0d74f0a0fbf2e.html">Anonymity</a></li><li class="navelem"><a class="el" href="../../dir_44fdcbe7c975f3ba81121e05bd6b37ea.html">Tolerant</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">TolerantBulkRound.hpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#ifndef DISSENT_ANONYMITY_TOLERANT_TOLERANT_BULK_ROUND_H_GUARD</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define DISSENT_ANONYMITY_TOLERANT_TOLERANT_BULK_ROUND_H_GUARD</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;QMetaEnum&gt;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;QSharedPointer&gt;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;Anonymity/Log.hpp&quot;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;Anonymity/MessageRandomizer.hpp&quot;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;Anonymity/Round.hpp&quot;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;Messaging/BufferSink.hpp&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;Messaging/GetDataCallback.hpp&quot;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;Utils/Triple.hpp&quot;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;Utils/Random.hpp&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;Accusation.hpp&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;AlibiData.hpp&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;Conflict.hpp&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;MessageHistory.hpp&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="keyword">namespace </span>Dissent {</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="keyword">namespace </span>Crypto {</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <span class="keyword">class </span>DiffieHellman;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <span class="keyword">class </span>Library;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;}</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="keyword">namespace </span>Utils {</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keyword">class </span>Random;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;}</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="keyword">namespace </span>Anonymity {</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="keyword">class </span>ShuffleRound;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="keyword">namespace </span>Tolerant {</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno"><a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html">   38</a></span>&#160;  <span class="keyword">class </span><a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html" title="Dissent &quot;v3&quot; Bulk.">TolerantBulkRound</a> : <span class="keyword">public</span> <a class="code" href="../../d3/d6f/classDissent_1_1Anonymity_1_1Round.html" title="An anonymous exchange amongst peers of a static group.">Dissent::Anonymity::Round</a> {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    Q_OBJECT</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    Q_ENUMS(<a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#aea67d6743a02e72abfbf725d847b3f54" title="Various stages of the bulk.">State</a>);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    Q_ENUMS(<a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a230559c0d4914a01a35dd2cbe3cffe73" title="States of gathering blame evidence.">EvidenceState</a>);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    Q_ENUMS(<a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#af4564e125905bc89cdf1350ba2f8812d" title="Headers to use for different sub-rounds.">RoundTypeHeader</a>);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    Q_ENUMS(<a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#ac277cdbe8b354b4ddfdbf26f2539b3bb" title="Various message types sent and received.">MessageType</a>);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      <span class="keyword">typedef</span> <a class="code" href="../../dd/d76/classDissent_1_1Anonymity_1_1Log.html" title="Maintains a historical mapping of a packet to an Id.">Dissent::Anonymity::Log</a> <a class="code" href="../../dd/d76/classDissent_1_1Anonymity_1_1Log.html" title="Maintains a historical mapping of a packet to an Id.">Log</a>;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      <span class="keyword">typedef</span> <a class="code" href="../../d9/de3/classDissent_1_1Anonymity_1_1MessageRandomizer.html" title="Wrapper class for randomizing and derandomizing message text.">Dissent::Anonymity::MessageRandomizer</a> <a class="code" href="../../d9/de3/classDissent_1_1Anonymity_1_1MessageRandomizer.html" title="Wrapper class for randomizing and derandomizing message text.">MessageRandomizer</a>;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      <span class="keyword">typedef</span> <a class="code" href="../../d3/d6f/classDissent_1_1Anonymity_1_1Round.html" title="An anonymous exchange amongst peers of a static group.">Dissent::Anonymity::Round</a> <a class="code" href="../../d3/d6f/classDissent_1_1Anonymity_1_1Round.html" title="An anonymous exchange amongst peers of a static group.">Round</a>;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      <span class="keyword">typedef</span> <a class="code" href="../../d7/d61/classDissent_1_1Crypto_1_1DiffieHellman.html" title="Stores a Diffie-Hellman exchange &ndash; shared secret exchanged in plaintext.">Dissent::Crypto::DiffieHellman</a> <a class="code" href="../../d7/d61/classDissent_1_1Crypto_1_1DiffieHellman.html" title="Stores a Diffie-Hellman exchange &ndash; shared secret exchanged in plaintext.">DiffieHellman</a>;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      <span class="keyword">typedef</span> <a class="code" href="../../df/df2/classDissent_1_1Crypto_1_1Hash.html" title="Cryptographic hashing algorithm.">Dissent::Crypto::Hash</a> <a class="code" href="../../df/df2/classDissent_1_1Crypto_1_1Hash.html" title="Cryptographic hashing algorithm.">Hash</a>;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      <span class="keyword">typedef</span> <a class="code" href="../../d1/d2f/classDissent_1_1Crypto_1_1Library.html">Dissent::Crypto::Library</a> <a class="code" href="../../d1/d2f/classDissent_1_1Crypto_1_1Library.html">Library</a>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      <span class="keyword">typedef</span> <a class="code" href="../../dc/d2c/classDissent_1_1Messaging_1_1BufferSink.html" title="Handle asynchronous data input storage.">Dissent::Messaging::BufferSink</a> <a class="code" href="../../dc/d2c/classDissent_1_1Messaging_1_1BufferSink.html" title="Handle asynchronous data input storage.">BufferSink</a>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      <span class="keyword">typedef</span> <a class="code" href="../../dd/d45/classDissent_1_1Messaging_1_1Request.html" title="Represents the state of an Request.">Dissent::Messaging::Request</a> <a class="code" href="../../dd/d45/classDissent_1_1Messaging_1_1Request.html" title="Represents the state of an Request.">Request</a>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      <span class="keyword">typedef</span> <a class="code" href="../../d0/da8/classDissent_1_1Messaging_1_1GetDataMethod.html">Dissent::Messaging::GetDataMethod&lt;TolerantBulkRound&gt;</a> <a class="code" href="../../d0/da8/classDissent_1_1Messaging_1_1GetDataMethod.html">BulkGetDataCallback</a>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <span class="keyword">typedef</span> <a class="code" href="../../de/dad/classDissent_1_1Utils_1_1Random.html" title="Random number generator &ndash; base class is a singleton.">Dissent::Utils::Random</a> <a class="code" href="../../de/dad/classDissent_1_1Utils_1_1Random.html" title="Random number generator &ndash; base class is a singleton.">Random</a>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div>
<div class="line"><a name="l00061"></a><span class="lineno"><a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#aea67d6743a02e72abfbf725d847b3f54">   61</a></span>&#160;      <span class="keyword">enum</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#aea67d6743a02e72abfbf725d847b3f54" title="Various stages of the bulk.">State</a> {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        State_Offline,</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        State_SigningKeyShuffling,</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        State_CommitSharing,</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        State_DataSharing,</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        State_BlameShuffling,</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        State_BlameAlibiSharing,</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        State_BlameProofSharing,</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        State_Finished</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      };</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div>
<div class="line"><a name="l00075"></a><span class="lineno"><a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a230559c0d4914a01a35dd2cbe3cffe73">   75</a></span>&#160;      <span class="keyword">enum</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a230559c0d4914a01a35dd2cbe3cffe73" title="States of gathering blame evidence.">EvidenceState</a> {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        NotLookingForEvidence,</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        LookingForEvidence,</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        FoundEvidence </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      };</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#af4564e125905bc89cdf1350ba2f8812d">   84</a></span>&#160;      <span class="keyword">enum</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#af4564e125905bc89cdf1350ba2f8812d" title="Headers to use for different sub-rounds.">RoundTypeHeader</a> {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        Header_SigningKeyShuffle,</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        Header_Bulk,</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        Header_BlameShuffle</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      };</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div>
<div class="line"><a name="l00094"></a><span class="lineno"><a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a7f9792f3290fa01bb574aad7d028acf0">   94</a></span>&#160;      <span class="keyword">static</span> QString <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a7f9792f3290fa01bb574aad7d028acf0" title="Converts a MessageType into a QString.">StateToString</a>(<a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#aea67d6743a02e72abfbf725d847b3f54" title="Various stages of the bulk.">State</a> st)</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keywordtype">int</span> index = staticMetaObject.indexOfEnumerator(<span class="stringliteral">&quot;State&quot;</span>);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keywordflow">return</span> staticMetaObject.enumerator(index).valueToKey(st);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      }</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div>
<div class="line"><a name="l00103"></a><span class="lineno"><a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#ac277cdbe8b354b4ddfdbf26f2539b3bb">  103</a></span>&#160;      <span class="keyword">enum</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#ac277cdbe8b354b4ddfdbf26f2539b3bb" title="Various message types sent and received.">MessageType</a> {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        MessageType_UserCommitData = 0,</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        MessageType_ServerCommitData = 1,</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        MessageType_UserBulkData = 2,</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        MessageType_ServerBulkData = 3,</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        MessageType_UserAlibiData = 4,</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        MessageType_ServerAlibiData = 5,</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        MessageType_UserProofData = 6,</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        MessageType_ServerProofData = 7</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      };</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div>
<div class="line"><a name="l00118"></a><span class="lineno"><a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#afe63ed48dc12f5876fd77d180c37329d">  118</a></span>&#160;      <span class="keyword">static</span> QString <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#afe63ed48dc12f5876fd77d180c37329d" title="Converts a MessageType into a QString.">MessageTypeToString</a>(<a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#ac277cdbe8b354b4ddfdbf26f2539b3bb" title="Various message types sent and received.">MessageType</a> mt)</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="keywordtype">int</span> index = staticMetaObject.indexOfEnumerator(<span class="stringliteral">&quot;MessageType&quot;</span>);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keywordflow">return</span> staticMetaObject.enumerator(index).valueToKey(mt);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      <span class="keyword">explicit</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#abc6284e77851205b1b91b6ff6b1515c5" title="Constructor.">TolerantBulkRound</a>(<span class="keyword">const</span> Group &amp;group, </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;          <span class="keyword">const</span> PrivateIdentity &amp;ident, <span class="keyword">const</span> Id &amp;round_id, </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;          QSharedPointer&lt;Network&gt; network, GetDataCallback &amp;get_data,</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;          CreateRound create_shuffle = &amp;TCreateRound&lt;ShuffleRound&gt;);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div>
<div class="line"><a name="l00142"></a><span class="lineno"><a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a78e18906265d8a6b70c04f9794214f41">  142</a></span>&#160;      <span class="keyword">virtual</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a78e18906265d8a6b70c04f9794214f41" title="Destructor.">~TolerantBulkRound</a>() {}</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div>
<div class="line"><a name="l00148"></a><span class="lineno"><a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#aac4ffe37a332fd2baf28bd33ae8c8c2e">  148</a></span>&#160;      <span class="keyword">inline</span> <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#aac4ffe37a332fd2baf28bd33ae8c8c2e" title="Notifies the round that a new peer has joined the session.">PeerJoined</a>() { _stop_next = <span class="keyword">true</span>; }</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      <span class="keywordtype">void</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#aa6eba2f4a2b83555143a9fb46bb3eca8" title="Mark an anonymous transmission slot as bad.">FoundBadSlot</a>(<span class="keywordtype">int</span> idx);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      <span class="keywordtype">void</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a4cf62dadfa54c92699a78acf770b8a03" title="Stop the round because a bad member was found.">FoundBadMembers</a>();</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div>
<div class="line"><a name="l00164"></a><span class="lineno"><a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a6f3fdf04f6f1e8c85dcf182848705e7f">  164</a></span>&#160;      <span class="keyword">inline</span> <span class="keyword">virtual</span> <span class="keyword">const</span> QVector&lt;int&gt; &amp;<a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a6f3fdf04f6f1e8c85dcf182848705e7f" title="Returns a list of members who have been blamed in the round.">GetBadMembers</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _bad_members; }</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#af6155c40f6d8c1af1254e762bbf0121d" title="Handle a data message from a remote peer.">IncomingData</a>(<span class="keyword">const</span> Request &amp;notification);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div>
<div class="line"><a name="l00175"></a><span class="lineno"><a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a441107789f1dabc8bcd988f28cee1e41">  175</a></span>&#160;      <span class="keyword">inline</span> <span class="keyword">virtual</span> QString <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a441107789f1dabc8bcd988f28cee1e41" title="QString rep.">ToString</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="keyword">      </span>{</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="keywordflow">return</span> <span class="stringliteral">&quot;TolerantBulkRound: &quot;</span> + <a class="code" href="../../d3/d6f/classDissent_1_1Anonymity_1_1Round.html#a43c973bb6b4bdb39e70547d141657ea4" title="Returns the round id.">GetRoundId</a>().<a class="code" href="../../df/d5b/classDissent_1_1Connections_1_1Id.html#ac72f1ffb358d3dd5baea549edc1841ef" title="Returns a printable Id string.">ToString</a>() +</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;          <span class="stringliteral">&quot; Phase: &quot;</span> + QString::number(_phase);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div>
<div class="line"><a name="l00185"></a><span class="lineno"><a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#ad25bf23f164795d4ab968068140d3c8f">  185</a></span>&#160;      <span class="keyword">inline</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#aea67d6743a02e72abfbf725d847b3f54" title="Various stages of the bulk.">State</a> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#ad25bf23f164795d4ab968068140d3c8f" title="Internal bulk state.">GetState</a>() { <span class="keywordflow">return</span> _state; }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div>
<div class="line"><a name="l00190"></a><span class="lineno"><a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a870c65e6e60807c58cbbee0c238698cf">  190</a></span>&#160;      QSharedPointer&lt;Round&gt; <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a870c65e6e60807c58cbbee0c238698cf" title="Returns the ShuffleRound used to exchange anon signing keys.">GetKeyShuffleRound</a>() { <span class="keywordflow">return</span> _key_shuffle_round; }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div>
<div class="line"><a name="l00195"></a><span class="lineno"><a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a2f24bde4a33bbfaa1ab2d174465cdf97">  195</a></span>&#160;      QSharedPointer&lt;Round&gt; <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a2f24bde4a33bbfaa1ab2d174465cdf97" title="Returns the Blame ShuffleRound used to accuse a group member.">GetBlameShuffleRound</a>() { <span class="keywordflow">return</span> _blame_shuffle_round; }</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keyword">protected</span>:</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#acc86e789ec1224289864fcabc8ae207c" title="Called when the BulkRound is started.">OnStart</a>();</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="comment">/*******************************************</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">       * Methods Shared Among Message Types</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a58890f5e35c04b9db7ee3cfb0fb22ae0" title="If data is from a legitimate group member, it is processed.">ProcessData</a>(<span class="keyword">const</span> Id &amp;from, <span class="keyword">const</span> QByteArray &amp;data);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      <span class="keywordtype">void</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#acfaf5884e6a22e7ec7128241e152eb64" title="This function does the hard work of processing data packets and throws exceptions for invalid data pa...">ProcessDataBase</a>(<span class="keyword">const</span> Id &amp;from, <span class="keyword">const</span> QByteArray &amp;data);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      <span class="comment">/*******************************************</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">       * Anonymous Signing Key Shuffle Methods</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      QPair&lt;QByteArray, bool&gt; <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a6ea891d4d7ace05e0312c10f035f33aa" title="Returns the signing key for sending in the shuffle round.">GetKeyShuffleData</a>(<span class="keywordtype">int</span> max);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      QSharedPointer&lt;AsymmetricKey&gt; <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a496c7e9d2737282103853dd13af5b764" title="Parse a signing key received in a key shuffle  bytearray representing the public verification key...">ParseSigningKey</a>(<span class="keyword">const</span> QByteArray &amp;bdes);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      <span class="comment">/*******************************************</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">       * Commit Data Methods</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <span class="keywordtype">void</span> SendCommits();</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      <span class="keywordtype">void</span> HandleUserCommitData(QDataStream &amp;stream, <span class="keyword">const</span> Id &amp;from);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <span class="keywordtype">void</span> HandleServerCommitData(QDataStream &amp;stream, <span class="keyword">const</span> Id &amp;from);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a714631b044e5c769ee711018a1afc17c" title="True when a node has all commit messages for a phase.">HasAllCommits</a>();</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#aae3a5bf1d4c9bf834a7acbe515f43974" title="Use alibis to figure out which nodes disagree on corrupted bit(s)">FinishCommitPhase</a>();</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      <span class="comment">/*******************************************</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">       * Bulk Data Methods</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      <span class="keywordtype">void</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#ab05a7fbf47148a11f139903f9555f349" title="Parses and handles bulk data messages from users.">HandleUserBulkData</a>(<span class="keyword">const</span> QByteArray &amp;packet, QDataStream &amp;stream, <span class="keyword">const</span> Id &amp;from);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      <span class="keywordtype">void</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#ae3a22fa09b5630394f0668f008c26bda" title="Parses and handles bulk data messages from servers.">HandleServerBulkData</a>(<span class="keyword">const</span> QByteArray &amp;packet, QDataStream &amp;stream, <span class="keyword">const</span> Id &amp;from);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a651cfdf70ffce98a2820a255ba6dde7d" title="True when a node has all bulk data messages for a phase.">HasAllDataMessages</a>();</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      <span class="keywordtype">void</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a4fc5488bbbf867e196e7f1b7196081a9" title="Once all bulk data messages have been received, parse them.">ProcessMessages</a>();</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      <span class="keywordtype">void</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a6df635eb81967ad7bc16f471659ab232" title="Make sure that every message hashes to the matching commit.">CheckCommits</a>(<span class="keyword">const</span> QVector&lt;QByteArray&gt; &amp;commits, <span class="keyword">const</span> QVector&lt;QByteArray&gt; &amp;digests,</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;          QVector&lt;int&gt; &amp;bad);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      QByteArray <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a991fefdd30e8a81dcac3d2ae41ad35f8" title="Parse the clear text message returning back the entry if the contents are valid.">ProcessMessage</a>(<span class="keyword">const</span> QByteArray &amp;cleartext, uint member_idx);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      <span class="keyword">virtual</span> QByteArray <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a07eb4b16ea3d993214d8b92ac9d78507" title="Wrapper for anonymous signing functionality.">SignMessage</a>(<span class="keyword">const</span> QByteArray &amp;cleartext);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      QByteArray <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a3a7ca3a93ccb0b683279c87b44453b5c" title="Prepares the local members cleartext message returns the local members cleartext message.">GenerateMyCleartextMessage</a>();</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      <span class="keyword">virtual</span> QByteArray <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a1752af21af6035cebec5b2a9f1eaa404" title="Generate the XOR pad that the user should generate with the specifed server.">GeneratePadWithServer</a>(uint server_idx, uint length);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      <span class="keyword">virtual</span> QByteArray <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a684327d258bb7d506ff57aefe832baaf" title="Generate the XOR pad that the server should generate with the specifed user.">GeneratePadWithUser</a>(uint user_idx, uint length);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      <span class="keyword">virtual</span> QByteArray <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#ae8116d3fec7822f464201528d922d165" title="Generates the user&#39;s entire xor message.">GenerateUserXorMessage</a>();</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      <span class="keyword">virtual</span> QByteArray <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a7cf39eb5d641cbbfaed5984f04dacd7a" title="Generates the server&#39;s entire xor message.">GenerateServerXorMessage</a>();</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      <span class="keywordtype">void</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#abf924810628b54fecafe685d583e3990" title="Copy all received messages to the message history data structure.">SaveMessagesToHistory</a>();</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#ab746522b08f93885fc53ea22b3473e95" title="Check if any bits in sent_msg were changed from zero to one in transmission Returns true if blame evi...">SearchForEvidence</a>(<span class="keyword">const</span> QByteArray&amp; sent_msg, <span class="keyword">const</span> QByteArray&amp; recvd_msg);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      <span class="comment">/*******************************************</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">       * Accusation/Blame Shuffle Methods</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      <span class="keywordtype">void</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a80a2080528aee5433a3f5e0b9263284b" title="Clear all blame and accusation data for a new blame shuffle.">ResetBlameData</a>();</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <span class="keywordtype">void</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a5b5ae50d5c96961df0a43efc2303d21d" title="If there is a corrupted bulk message, run an accusation shuffle.">RunBlameShuffle</a>();</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      QPair&lt;QByteArray, bool&gt; <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#af8a0176c919837c66b3afb57aca0690f" title="Returns the accusation for sending in the shuffle round.">GetBlameShuffleData</a>(<span class="keywordtype">int</span> max);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      <span class="comment">/*******************************************</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">       * Alibi Data Methods</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a2f44b615bb943b0ab38a6f8e224943a2" title="Broadcast bitmasks proving user innocence with respect to a set of accusations in a blame round A map...">SendUserAlibis</a>(<span class="keyword">const</span> QMap&lt;int, Accusation&gt; &amp;map);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a8bcae7d8befebafa702479daa2baa405" title="Broadcast bitmasks proving server innocence with respect to a set of accusations in a blame round A m...">SendServerAlibis</a>(<span class="keyword">const</span> QMap&lt;int, Accusation&gt; &amp;map);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      <span class="keywordtype">void</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a4fb49e080e6f3fad03d714e634dc53ef" title="Parses and handles user alibi data messages in blame process.">HandleUserAlibiData</a>(QDataStream &amp;stream, <span class="keyword">const</span> Id &amp;from);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      <span class="keywordtype">void</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a4c57ddd50054723be5f4044df16a6299" title="Parses and handles server alibi data messages in blame process.">HandleServerAlibiData</a>(QDataStream &amp;stream, <span class="keyword">const</span> Id &amp;from);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a9cc3ef89ac72f02b9a83502698bc9312" title="True when a node has all alibi messages for a phase.">HasAllAlibis</a>();</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      <span class="keywordtype">void</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a42ed4c87716cbdc554ea8aab05fe1f60" title="Use alibis to figure out which nodes disagree on corrupted bit(s)">RunAlibiAnalysis</a>();</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      <span class="keywordtype">void</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#acea954efc97d3d222dd37a5dc0d4f64f" title="Look through blame conflicts and send proofs of innocence where necessary.">ProcessConflicts</a>();</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      <span class="comment">/*******************************************</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">       * Proof Data Methods</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      <span class="keywordtype">void</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#ab4d52d21eda778775f1548e4ba772c8e" title="Parses and handles proof messages in blame process.">HandleUserProofData</a>(QDataStream &amp;stream, <span class="keyword">const</span> Id &amp;from);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      <span class="keywordtype">void</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a80ceea58935d3dcd5b3785bf15b5dfde" title="Parses and handles proof messages from servers.">HandleServerProofData</a>(QDataStream &amp;stream, <span class="keyword">const</span> Id &amp;from);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a2802673c7dc4a5f4b788288a6dca8aec" title="True when a node has all proof messages for a phase.">HasAllProofs</a>();</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      <span class="keywordtype">void</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#af5b9c7e5c628a9b9c2eca58ed1b0da08" title="Use NZKPs to check revealed secrets.">RunProofAnalysis</a>();</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      <span class="keywordtype">void</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a17b19a5cf09f92c5e433423470bf8d4c" title="Send proof of a user&#39;s DH secret.">SendUserProof</a>(<span class="keywordtype">int</span> conflict_idx, uint server_idx);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      <span class="keywordtype">void</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#aa9f4e7c4b0bef9de924ac4ae9d27d6fc" title="Send proof of a server&#39;s DH secret.">SendServerProof</a>(<span class="keywordtype">int</span> conflict_idx, uint user_idx);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a8db0f441b29438988aec44f941662b28" title="Get the bit that a should be in the bit index indicated by the accusation when the given RNG seed is ...">GetExpectedBit</a>(uint slot_idx, <a class="code" href="../../da/d19/classDissent_1_1Anonymity_1_1Tolerant_1_1Accusation.html" title="Accusation holds the information that an anonymous slot owner submits to a blame/accusation shuffle w...">Accusation</a> &amp;acc, QByteArray &amp;seed);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      <span class="comment">/**************************************************/</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;      <span class="comment">/*******************************************</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">       * Phase Change Methods</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      <span class="keywordtype">void</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#aa3d1a8789f206437c6ae914578f5741a" title="Does all the prep work for the next phase, clearing and zeroing out all the necessary fields...">PrepForNextPhase</a>();</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      <span class="keywordtype">void</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#ab4d7dd08f0cfc7527a2e025f1970f677" title="Called when has received all bulk data messages.">FinishPhase</a>();</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      <span class="keywordtype">void</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a52deba96584e7d463a7504c19f5a9804" title="Mark a single member as bad.">AddBadMember</a>(<span class="keywordtype">int</span> member_id);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;      <span class="keywordtype">void</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a175dc760249508594e470cf20cf382ef" title="Add a vector of faulty members to the bad members set.">AddBadMembers</a>(<span class="keyword">const</span> QVector&lt;int&gt; &amp;more); </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      <span class="comment">/*******************************************</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">       * Protected getters</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      <span class="keyword">inline</span> QVector&lt;QSharedPointer&lt;Random&gt; &gt; &amp;GetRngsWithServers() { <span class="keywordflow">return</span> _rngs_with_servers; }</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;      <span class="keyword">inline</span> QVector&lt;QSharedPointer&lt;Random&gt; &gt; &amp;GetRngsWithUsers() { <span class="keywordflow">return</span> _rngs_with_users; }</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      <span class="keyword">inline</span> <span class="keyword">const</span> AlibiData &amp;GetUserAlibiData()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _user_alibi_data; }</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      <span class="keyword">inline</span> <span class="keyword">const</span> AlibiData &amp;GetServerAlibiData()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _server_alibi_data; }</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;      <span class="keyword">inline</span> uint GetPhase()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _phase; }</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      <span class="keyword">inline</span> <span class="keywordtype">bool</span> IsServer()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _is_server; }</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      <span class="keyword">inline</span> <span class="keyword">const</span> QByteArray &amp;GetNextUserPacket()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _user_next_packet; }</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      <span class="keyword">inline</span> <span class="keyword">const</span> QByteArray &amp;GetNextServerPacket()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _server_next_packet; }</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      <span class="keywordtype">void</span> <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a1d0b3211e8fe812c13fde7c37d3cc91c" title="Change the round state and process logged messages received for this state.">ChangeState</a>(<a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#aea67d6743a02e72abfbf725d847b3f54" title="Various stages of the bulk.">State</a> new_state);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="keyword">private</span>:</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      <span class="keywordtype">void</span> CreateBlameShuffle();</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      <span class="keywordtype">bool</span> ReadyForMessage(<a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#ac277cdbe8b354b4ddfdbf26f2539b3bb" title="Various message types sent and received.">MessageType</a> mtype);</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      <span class="keywordtype">bool</span> _is_server;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;      <span class="keywordtype">bool</span> _stop_next;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;      <span class="keywordtype">bool</span> _waiting_for_blame;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      QVector&lt;QByteArray&gt; _secrets_with_servers;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      QVector&lt;QSharedPointer&lt;Random&gt; &gt; _rngs_with_servers;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      QVector&lt;QByteArray&gt; _secrets_with_users;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      QVector&lt;QSharedPointer&lt;Random&gt; &gt; _rngs_with_users;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      BulkGetDataCallback _get_key_shuffle_data;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      BulkGetDataCallback _get_blame_shuffle_data;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;      CreateRound _create_shuffle;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;      <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#aea67d6743a02e72abfbf725d847b3f54" title="Various stages of the bulk.">State</a> _state;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;      Log _offline_log;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;      Log _log;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      Library *_crypto_lib;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      QSharedPointer&lt;Hash&gt; _hash_algo;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      QSharedPointer&lt;AsymmetricKey&gt; _anon_signing_key;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      QVector&lt;QSharedPointer&lt;Random&gt; &gt; _anon_rngs;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;      QSharedPointer&lt;Round&gt; _key_shuffle_round;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;      QSharedPointer&lt;Round&gt; _blame_shuffle_round;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      BufferSink _key_shuffle_sink;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;      BufferSink _blame_shuffle_sink;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      uint _expected_bulk_size;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;      QVector&lt;uint&gt; _header_lengths;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      QVector&lt;uint&gt; _message_lengths;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;      uint _phase;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;      QByteArray _user_next_packet;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;      QByteArray _server_next_packet;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;      QVector&lt;QByteArray&gt; _user_commits;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;      QVector&lt;QByteArray&gt; _server_commits;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;      uint _received_user_commits;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      uint _received_server_commits;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;      QVector&lt;QByteArray&gt; _user_messages;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;      QVector&lt;QByteArray&gt; _server_messages;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;      QVector&lt;QByteArray&gt; _user_message_digests;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;      QVector&lt;QByteArray&gt; _server_message_digests;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;      uint _received_user_messages;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      uint _received_server_messages;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      MessageRandomizer _message_randomizer;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;      MessageHistory _message_history;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;      QVector&lt;QByteArray&gt; _expected_msgs;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;      QByteArray _next_msg;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;      QByteArray _last_msg;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      QByteArray _last_msg_cleartext;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      QVector&lt;QSharedPointer&lt;AsymmetricKey&gt; &gt; _slot_signing_keys;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      QByteArray _key_shuffle_data;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;      uint _my_idx;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;      uint _user_idx;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;      uint _server_idx;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;      QVector&lt;int&gt; _bad_members;</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;      QSet&lt;int&gt; _bad_slots;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;      QSet&lt;int&gt; _corrupted_slots;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;      <a class="code" href="../../d7/d22/classDissent_1_1Anonymity_1_1Tolerant_1_1TolerantBulkRound.html#a230559c0d4914a01a35dd2cbe3cffe73" title="States of gathering blame evidence.">EvidenceState</a> _looking_for_evidence;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;      Accusation _accusation;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;      QMap&lt;int, Accusation&gt; _acc_data;</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;      AlibiData _user_alibi_data;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;      AlibiData _server_alibi_data;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      QVector&lt;QByteArray&gt; _user_alibis;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;      QVector&lt;QByteArray&gt; _server_alibis;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;      uint _expected_alibi_qty;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;      uint _user_alibis_received;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;      uint _server_alibis_received;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      QList&lt;Conflict&gt; _conflicts;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;      QVector&lt;QByteArray&gt; _user_proofs;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;      QVector&lt;QByteArray&gt; _server_proofs;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;      uint _user_proofs_received;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;      uint _server_proofs_received;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <span class="keyword">private</span> slots:</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;      <span class="keywordtype">void</span> KeyShuffleFinished();</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;      <span class="keywordtype">void</span> BlameShuffleFinished();</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  };</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;}</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;}</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;}</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="preprocessor">#endif</span></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Jun 28 2012 16:24:41 for Dissent by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.1.1
</small></address>
</body>
</html>
